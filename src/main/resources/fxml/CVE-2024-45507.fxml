<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ChoiceBox?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.text.Text?>

<AnchorPane prefHeight="647.0" prefWidth="1046.0" stylesheets="@../css/main.css" xmlns="http://javafx.com/javafx/22" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.tyby.javaapacheexp.controller.CVE_2024_45507_Controller">

   <children>

      <TabPane>
         <tabs>
            <!-- ******************  单体检测  ************************   -->
            <Tab text="单体检测">
               <AnchorPane>
                  <Text layoutX="26.0" layoutY="26.0" strokeType="OUTSIDE" strokeWidth="0.0" text="目标地址：" wrappingWidth="84.66668701171875">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </Text>
                  <TextField fx:id="url" layoutX="122.0" layoutY="5.0" prefHeight="29.0" prefWidth="432.0" promptText="http://127.0.0.1">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </TextField>
                  <Text layoutX="26.0" layoutY="71.0" strokeType="OUTSIDE" strokeWidth="0.0" text="vps地址：" wrappingWidth="84.66668701171875">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </Text>
                  <TextField fx:id="vpsUrl" layoutX="122.0" layoutY="50.0" prefHeight="29.0" prefWidth="432.0" promptText="http://vps:port">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </TextField>
                  <Text layoutX="26.0" layoutY="120.0" strokeType="OUTSIDE" strokeWidth="0.0" text="反弹shell：" wrappingWidth="84.66668701171875">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </Text>
                  <TextField fx:id="vpsShell" layoutX="122.0" layoutY="99.0" prefHeight="29.0" prefWidth="432.0" promptText="bash反弹shell监听的ip和端口,IP:port形式">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </TextField>
                  <Button layoutX="580.0" layoutY="99.0" onAction="#createRCExml" prefHeight="31.0" prefWidth="103.0" text="生成rce.xml">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </Button>
                  <Button layoutX="889.0" layoutY="99.0" onAction="#check" prefHeight="29.0" prefWidth="85.0" text="利用">
                     <font>
                        <Font size="15.0" />
                     </font>
                  </Button>


                  <TabPane layoutX="14.0" layoutY="149.0" prefHeight="495.0" prefWidth="1048.0">
                     <tabs>
                        <Tab text="基本信息">
                           <content>
                              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="644.0" prefWidth="901.0">
                                 <children>
                                    <TextArea fx:id="basic_info" layoutX="14.0" layoutY="-2.0" prefHeight="583.0" prefWidth="1048.0" AnchorPane.bottomAnchor="-0.6666666666666288" AnchorPane.leftAnchor="14.0" AnchorPane.rightAnchor="-13.333333333333485" AnchorPane.topAnchor="-2.0">
                                       <font>
                                          <Font size="14.0" />
                                       </font></TextArea>
                                 </children>
                              </AnchorPane>
                           </content>
                        </Tab>
                        <Tab text="命令执行">
                           <content>
                              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                                 <children>
                                    <TextField fx:id="cmd" layoutX="133.0" layoutY="5.0" prefHeight="27.0" prefWidth="498.0" promptText="whoami">
                                       <font>
                                          <Font size="15.0" />
                                       </font></TextField>
                                    <ChoiceBox fx:id="encoding" layoutX="692.0" layoutY="4.0" prefHeight="21.0" prefWidth="107.0" />
                                    <TextArea fx:id="cmd_info" layoutY="40.0" prefHeight="539.0" prefWidth="1048.0">
                                       <font>
                                          <Font size="15.0" />
                                       </font></TextArea>
                                    <Text layoutX="50.0" layoutY="25.0" strokeType="OUTSIDE" strokeWidth="0.0" text="命令">
                                       <font>
                                          <Font size="15.0" />
                                       </font>
                                    </Text>
                                    <Button fx:id="execute" layoutX="861.0" layoutY="4.0" onAction="#get_execute_cmd" prefHeight="21.0" prefWidth="66.0" text="执行" />
                                 </children>
                              </AnchorPane>
                           </content>
                        </Tab>
                        <Tab text="文件上传">
                           <content>
                              <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                                 <children>
                                    <TextArea fx:id="upload_info" layoutY="38.0" prefHeight="384.0" prefWidth="1048.0" AnchorPane.bottomAnchor="158.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="38.0">
                                       <font>
                                          <Font size="15.0" />
                                       </font></TextArea>
                                    <TextField fx:id="upload_path" layoutX="154.0" layoutY="5.0" prefHeight="29.0" prefWidth="474.0" promptText="test.jsp">
                                       <font>
                                          <Font size="15.0" />
                                       </font></TextField>
                                    <Text layoutX="58.0" layoutY="25.0" strokeType="OUTSIDE" strokeWidth="0.0" text="文件名">
                                       <font>
                                          <Font size="15.0" />
                                       </font>
                                    </Text>
                                    <ChoiceBox fx:id="platform" layoutX="711.0" layoutY="4.0" prefHeight="27.0" prefWidth="85.0" />
                                    <TextArea fx:id="upload_msg" layoutY="423.0" prefHeight="160.0" prefWidth="1048.0">
                                       <font>
                                          <Font size="15.0" />
                                       </font></TextArea>
                                    <Button fx:id="upload" layoutX="849.0" layoutY="1.0" onAction="#get_shell_file" prefHeight="35.0" prefWidth="100.0" text="上传文件" />
                                 </children>
                              </AnchorPane>
                           </content>
                        </Tab>
                     </tabs>
                  </TabPane>
               </AnchorPane>
            </Tab>


            <!-- ******************  批量检测  ************************   -->
<!--            <Tab text="批量检测">-->
<!--               <AnchorPane prefHeight="647.0" prefWidth="689.0">-->
<!--                  <children>-->
<!--                     <VBox layoutX="-1.0" layoutY="-5.0" prefHeight="654.0" prefWidth="1048.0">-->
<!--                        <children>-->
<!--                           <Pane prefHeight="117.0" prefWidth="1048.0">-->
<!--                              <children>-->
<!--                                 <Button layoutX="426.0" layoutY="7.0" mnemonicParsing="false" onAction="#handleImportFile" prefHeight="28.0" prefWidth="75.0" text="导入" />-->
<!--                                 <Button layoutX="943.0" layoutY="7.0" mnemonicParsing="false" onAction="#checkBatch" prefHeight="28.0" prefWidth="75.0" text="验证" />-->
<!--                                 <TextField fx:id="filePathId" layoutX="14.0" layoutY="8.0" onMouseClicked="#handleFileChooser" prefHeight="25.0" prefWidth="404.0" promptText="点击此处，导入txt文件" styleClass="text-field-border" />-->
<!--                                 <ChoiceBox fx:id="choice_cve_batch" layoutX="614.0" layoutY="8.0" prefHeight="27.0" prefWidth="127.0" />-->
<!--                                 <TextField fx:id="ldapURL" layoutX="687.0" layoutY="50.0" prefHeight="35.0" prefWidth="334.0" styleClass="text-field-border" />-->
<!--                                 <Label layoutX="606.0" layoutY="53.0" prefHeight="34.0" prefWidth="79.0" text="  Ldap地址：" />-->
<!--                              </children>-->
<!--                           </Pane>-->
<!--                           <Pane prefHeight="596.0" prefWidth="1041.0">-->
<!--                              <children>-->
<!--                                 <TextArea fx:id="fileContentTextArea" layoutX="7.0" layoutY="18.0" prefHeight="577.0" prefWidth="507.0" promptText="也可直接把urls，逐行粘贴此处" />-->
<!--                                 <TextArea fx:id="responseTextArea" layoutX="548.0" layoutY="16.0" prefHeight="579.0" prefWidth="500.0" />-->
<!--                              </children>-->
<!--                           </Pane>-->
<!--                        </children>-->
<!--                     </VBox>-->
<!--                  </children>-->
<!--               </AnchorPane>-->
<!--            </Tab>-->
         </tabs>
      </TabPane>



   </children>
</AnchorPane>

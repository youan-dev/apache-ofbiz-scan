package org.tyby.javaapacheexp.core;

import org.apache.log4j.Logger;
import org.tyby.javaapacheexp.controller.MainController;

import javax.naming.NamingException;
import java.net.MalformedURLException;
import java.util.Map;

/**
 * @author yhy
 * @date 2021/3/25 20:57
 * @github https://github.com/yhy0
 */

// exp 的接口，取自 shack2 的Java反序列化漏洞利用工具V1.7
public interface ExploitInterface {

    Logger logger = Logger.getLogger(MainController.class);

    String checkVul(Map map) throws MalformedURLException;

    String checkVul(String url) throws MalformedURLException;

    String newCheckVul(String url,String ldap) throws MalformedURLException, NamingException, NoSuchFieldException, IllegalAccessException;

    String exeCmd(String cmd, String encoding);

    String getWebPath();

    String uploadFile(String fileContent, String filename, String platform) throws Exception;

    boolean isVul();


}
